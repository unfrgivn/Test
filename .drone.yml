pipeline:
  test:
    image: node:latest
    commands:
      - npm install
      - npm run test
      - npm run build

  #Runs only when push to master
  docker:
    when:
      branch: master
      event: push
    image: plugins/docker
    secrets: [ docker_username, docker_password ] # Stored in Drone admin but not available to pull request events for security
    repo: unfrgivn/drone-client-test #Defaults to Docker Hub
    tags:
      - latest
      - "${DRONE_COMMIT:0:8}"
